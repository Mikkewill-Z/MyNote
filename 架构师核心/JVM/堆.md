 ![[Pasted image 20240131183654.png|600]]
## 概述
不同JDK版本中堆的区别
Jdk1.6及之前: 有永久代,常量池1.6在方法区
Jdk1.7: 有永久代,但已经逐步"去永久代",常量池在堆中
Jdk1.8之后: 无永久代,变成元空间,常量池在堆中

永久代使用的是JVM的堆内存,到那时java8后的元空间不在虚拟机中而是使用本机的物理内存

无论是哪个JDK版本,堆中都包含 新生区 和 养老区

## 区
### 新生区
![[Pasted image 20240131184236.png|600]]
新创建的对象放到新生区内
当新生区空间被占满的时候,在新生区内做普通GC(Minor GC),进行对象回收

新生区包含 伊甸区,from区(幸存0区),to区(幸存一区)

- **对象在什么情况下进入到养老区？**
情况1： 对象经过15次gc还存活，进行养老区

情况2： 特殊情况，比如对象特别大，大小超过新生区大小，这个对象不经过gc直接进入到养老区

-- 情况2有问题：如果对象特别特别大，比养老区大小都大，放不进去，直接抛出异常

### 养老区
养老区存放连接池对象

对象进入养老区后,当养老区空间满了,就执行Full GC
若执行FullGC之后,养老区还是满的状态,直接抛出错误
java虚拟机的堆内存设置不够,可以通过-Xms,-Xmx来调整

## 堆参数调优
![[Pasted image 20240131191048.png]]