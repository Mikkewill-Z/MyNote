# 介绍
不改变源程序代码的情况下为其添加新的功能.
代理思想[[代理模式#动态代理|代理]]
![[Pasted image 20231128093636.png|300]]
应用于:
	日志,[[AOP事务管理]],权限判断,性能监测,
# 使用
添加依赖包
	![[Pasted image 20231128103127.png|400]]

创建目标接口与实现类
![[Pasted image 20231128103148.png|500]]

![[Pasted image 20231128103258.png|500]]
添加配置文件
![[Pasted image 20231128103359.png|500]]
![[Pasted image 20231128103224.png|500]]
配置文件->配置类

# 增强类型
增强的注解后都需要添加具体执行方法,即增强的目标方法
## 前置增强
@before
## 后置增强
@afterThrowing
## 异常增强
@afterThrowing
## 最终增强
@after
## 环绕增强^[等价于前置加后置]
@Around
![[Pasted image 20231128111311.png|400]]
# 扩展
@pointCut
切入点复用
![[Pasted image 20231128141427.png]]

![[Pasted image 20231128143459.png|400]]

@order
若程序中出现多个切面类进行增强操作,使用order注解进行排序,order越小,优先级越高

## SpringAop对ioc的影响
在没有使用AOP的环境中,ioc生成的对象可以使用普通类,
接口,接口实现类来接收
如果使用了AOP,此时Spring框架会根据生成对象是普通类还是接口类型
采取不同的代理方式,给目标对象生成一个代理对象,此时接收对象只能用普通类对象或接口接收,接口的实现列不允许接收
# xml方式实现AOP
## 导入依赖
## 创建接口与实现类
因为是通过xml方式来实现
因此不通过添加注解的方式来实现类的创建
## 创建切面类
同样的,不添加aspect注解,而是通过配置文件中的
<aop: aspect ref="">来实现切面类的定义
标签内添加<aop: befor等 的各种类型的增强
	去建立目标方法和切面类方法之间的关系,定义切入点
	切入点通过pointcut-ref来进行定义
## 创建配置文件
在配置文件中实现上述的对象创建,切面类定义以及建立目标与切面方法联系等操作

# 事务注解的属性
@Transactional
### 只读属性
readonly = true^[一般加在查询方法上]
### 超时时间
(单位 秒) time=?,超过时间之后超时结束
### 异常
默认情况下,事务回滚的异常只能使运行时异常,编译时异常不会回滚
![[Pasted image 20231130190132.png|400]]
rollbackfor属性后添加想要进行事务回滚的异常的类型,可以实现编译时异常的回滚
相对应的 norollbackfor就是对属性后标记的异常类不回滚
### 事务的隔离级别
![[Pasted image 20231130191330.png|400]]
默认情况下根据数据库调整
isolation= ? 
mysql的隔离级别是可重复读
### 事务传播行为
属性默认为required
![[Pasted image 20231130194434.png|400]]

## xml实现声明式事务
![[Pasted image 20231130215759.png|400]]
这个方法在项目中的多层都存在,需要在哪一层管理这个方法就需要我们使用aop来进行定义
![[Pasted image 20231130220536.png|400]]
指定到的就是service中我们在attributes中定义的方法
![[Pasted image 20231130220722.png|400]]